import usb.core, usb.util, array

dev = list(usb.core.find(find_all=True, idVendor=0x273e, idProduct=0x0006))[0]

if dev.is_kernel_driver_active(0):
    reattach = True
    dev.detach_kernel_driver(0)
dev.set_configuration()

epout = 0x82
epin = 0x02

leftATT = array.array('B', [0xAB,0xF0,0xDF,0x0D, 0x04,0x00,0x00,0x00, 0x04,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x71])
rightATT = array.array('B', [0xAB,0xF0,0xDF,0x0D, 0x04,0x00,0x00,0x00, 0x04,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x72])
getATT = array.array('B', [0xAB,0xF0,0xDF,0x0D, 0x04,0x00,0x00,0x00, 0x04,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x7A])
setATT = array.array('B', [0xAB,0xF0,0xDF,0x0D, 0x04,0x00,0x00,0x00, 0x04,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x7B])
findZERO = array.array('B', [0xAB,0xF0,0xDF,0x0D, 0x04,0x00,0x00,0x00, 0x04,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x05])
readDATA = array.array('B', [0xAB,0xF0,0xDF,0x0D, 0x05,0x00,0x00,0x00, 0x02,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00])

#onREF = array.array('B', [0xAB,0xF0,0xDF,0x0D, 0x04,0x00,0x00,0x00, 0x04,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x74])
#offREF = array.array('B', [0xAB,0xF0,0xDF,0x0D, 0x04,0x00,0x00,0x00, 0x04,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x00,0x00,0x75])



def SetATT(ATT = 0.00):
    try:
        valATT = array.array('B', [0xAB,0xF0,0xDF,0x0D, 0x06,0x00,0x00,0x00, 0x04,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0,0,int(100*ATT)%256,int(ATT*100)//256])
        dev.write(epin, valATT); dev.read(epout, 64)
        dev.write(epin, setATT); dev.read(epout, 64)
    except:
        print('Incorrect value')

def Find0():
    dev.write(epin, findZERO); dev.read(epout, 64)

def GetATT():
    dev.write(epin, getATT); dev.read(epout, 64)
    dev.write(epin, readDATA); out= list(dev.read(epout, 64));
    print(str((256*out[-1]+out[-2])/100)+' dB')

def Up():
    dev.write(epin, rightATT); dev.read(epout, 64)

def Down():
    dev.write(epin, leftATT); dev.read(epout, 64)
    

    

#dev.read(epout, 64)
